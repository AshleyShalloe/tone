<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tone</title>
    <style>
        html {
            font-family: sans-serif;
            background: #e6e7e8;
        }

        body {
            margin: 0 auto;
            max-width: 500px;
            display: flex;
            flex-direction: column;
            align-content: center;
            justify-content: center;
            margin-top: 20px;
            margin-bottom: 20px;
        }

        .card {
            background: white;
            padding: 10px;
            margin-bottom: 10px;
            box-shadow: 5px 5px 5px lightgrey;
            position: relative;
            border-radius: 0.4em;
        }

        .card_hidden {
            height: 5px !important;
            overflow-y: hidden;
        }

        .card_hide_toggle {
            position: absolute;
            top: 0;
            right: 0;
            width: 1em;
            height: 1em;
            margin: 3px;
            background: lightgray;
            border-radius: 25% 25% 25% 100%;
            line-height: 1em;
        }

        .card_hidden>div {
            filter: opacity(0.1);
        }

        .card_hidden>.card_hide_toggle {
            background: grey;
        }

        #theGrid {
            background: #e6e7e8;
            color: white;
            text-align: center;
            user-select: none;
        }

        #theGrid td:first-of-type {
            background: #5986D9;
            color: white;
            font-weight: bold;
            padding-left: 3px;
            padding-right: 3px;
            cursor: default;
            border-radius: unset;
        }

        #theGrid td:first-of-type:hover {
            box-shadow: unset;
            background: #5986D9;
        }

        #theGrid td:hover {
            box-shadow: 0px 0px 3px black;
            background: rgba(255, 255, 255, 0.418);
        }

        #theGrid,
        #theGrid td,
        #theGrid tr,
        #theGrid th {
            border: 1px solid #cfcfcf;
            border-collapse: collapse;
            font-family: monospace;
        }

        #theGrid td {
            height: 25px;
            width: 25px;
            cursor: pointer;
            border-radius: 3px;
        }

        #theGrid th {
            height: 15px;
            width: 25px;
            background: lightgray;
            color: lightgray;
            cursor: pointer;
        }

        #theGrid th:hover {
            color: black;
            background: grey;
        }

        #theGrid tr:hover {
            background: rgb(181, 181, 181);
        }

        #theGrid tr:nth-child(12n) td {
            border-bottom: 1px solid #425d90 !important;
        }

        #theGrid tr:last-child td {
            border-bottom: unset !important;
        }

        #controls,
        #gridContainer {
            display: flex;
            justify-content: center;
            flex-direction: column;
            align-items: center;
            min-width: 450px;
        }

        #gridContainer {
            overflow-x: scroll;
            align-items: stretch;
        }

        button {
            margin: 3px;
        }

        select,
        input {
            background: white;
            color: black;
            box-shadow: 2px 2px 4px #80808080, -2px -2px 4px #ffffff6b;
            border-radius: 0.4em;
            border: 1px solid rgb(237, 237, 237);
            transition: border 0.5s;
            cursor: pointer;
            user-select: none;
            padding: 7px;
            margin: 3px;
        }

        .currentStep {
            background: #b9b9b9;
        }

        #theGrid td.activeCell {
            background: #B96AD2;
        }

        .skeuButton {
            background: white;
            color: black;
            box-shadow: 2px 2px 4px #80808080, -2px -2px 4px #ffffff6b;
            border-radius: 0.4em;
            border: 1px solid rgb(237, 237, 237);
            transition: border 0.5s;
            cursor: pointer;
            user-select: none;
            padding: 7px;
        }

        .skeuButton:active {
            color: darkblue;
            box-shadow: inset 2px 2px 4px #80808080, inset -2px -2px 4px #ffffff6b;
        }

        .skeuButton:disabled {
            color: lightgray;
        }

        .skeuButton:hover {
            border: 1px solid rgb(217, 217, 217);
        }

        #exportDiv textarea {
            height: 100px;
            margin: 5px;
            width: 100%;
            width: -moz-available;
            width: -webkit-fill-available;
            width: fill-available;
            border-radius: 0.4em;
        }

        #exportDiv {
            display: flex;
            flex-direction: column;
        }

        #loadExportButtonsDiv {
            display: flex;
            flex-direction: row;
            align-items: stretch;
            justify-content: space-between;
        }
    </style>
</head>

<body>

    <div id="controls" class="card">
        <table>
            <tr>
                <td>Steps</td>
                <td><input id="stepSpinner" type="number" oninput="stepChange(parseInt(this.value))" min="1" /></td>
            </tr>
            <tr>
                <td>Step duration</td>
                <td><input id="stepDurationSpinner" type="number" value="0.5" step="0.01" min="0.01" onchange="stepDurationChange(parseFloat(this.value))" /></td>
            </tr>
        </table>

        <div>
            <div>
                <button class="skeuButton" onclick="initAudioContext(); startAutoplay()">Start</button>
                <button class="skeuButton" onclick="stopAutoplay()">Stop</button>
                <button class="skeuButton" onclick="initAudioContext(); advanceStep()">Step</button>
                <button class="skeuButton" onclick="highlightStep(-1)">&lt;&lt;</button>
                <select id="waveformSelection" onchange="changeWaveform(this.value)">
                    <option disabled="" selected="">Waveform</option>
                    <option value="sine">Sine</option>
                    <option value="square">Square</option>
                    <option value="sawtooth">Sawtooth</option>
                    <option value="triangle">Triangle</option>
                </select>
            </div>
            <div>
                <!-- <button class="skeuButton" onclick="loadTrack(tracks.stillAlive)">Load</button> -->
                <button class="skeuButton" onclick="clearNotes()">Clear</button>
                <div id="trackSelection" style="display: inline-block"></div>
                <button class="skeuButton" onclick="doLoad()">Load</button>
                <button class="skeuButton" onclick="doExport()">Export</button>
            </div>
            <div>
                <button class="skeuButton" onclick="insertColAtCurrentPos()">Insert Column</button>
                <button class="skeuButton" onclick="wideMode()">Wide mode</button>
            </div>
        </div>
    </div>

    <div id="gridContainer" class="card">
        <table id="theGrid"></table>
    </div>

    <div id="postscript" class="card card_hidden">
        <span class='card_hide_toggle' onclick='hideCard(this)'></span>
        <p>This bit is experimental and likely to break everything</p>
        <table>
            <tr>
                <td>Number of octaves</td>
                <td><input id="octaveSpinner" type="number" value="2" step="1" min="2" onchange="octaveChange(parseFloat(this.value))" /></td>
            </tr>
            <tr>
                <td>Start octave</td>
                <td><input id="startOctaveSpinner" type="number" value="3" step="1" min="1" onchange="startOctaveChange(parseFloat(this.value))" /></td>
            </tr>
            <tr>
                <td>Bar length</td>
                <td><input id="barLengthSpinner" type="number" value="8" step="1" min="2" onchange="doBarShading(parseInt(this.value))"></input></td>
            </tr>
        </table>
    </div>

</body>
<script>
    'use strict'

    function stepChange(steps, noReload) {
        var theGrid = document.getElementById("theGrid")
        var stepSpinner = document.getElementById("stepSpinner")
        var currentTrack = getTheScore()
        var newGridHTML = []

        stepCount = steps
        currentTrack["steps"] = steps

        newGridHTML.push("<table><thead>")
        newGridHTML.push("<th>&#9660;</th>".repeat(steps + 1))
        newGridHTML.push("</thead><tbody>")
        for (var i = 0; i < numberOfOctaves * 12; i++) {
            var rowHTML = []
            rowHTML.push("<tr>")
            for (var j = 0; j < (steps + 1); j++) {
                var cellHTML = ""
                if (!j) {
                    var note = chromaticScale[12 - ((i % 12) + 1)]
                    var octave = startOctave + numberOfOctaves - (1 + Math.floor(i / 12))
                    cellHTML = `<td class='step_${j - 1}' data-note="${note}${octave}">${note}${octave}</td>`
                }
                else {
                    cellHTML = `<td class='step_${j - 1}'></td>`
                }
                rowHTML.push(cellHTML)
            }
            rowHTML.push("</tr>")
            newGridHTML.push(rowHTML.join("\n"))
        }
        newGridHTML.push("</tbody></table>")
        theGrid.innerHTML = newGridHTML.join("\n")
        stepSpinner.value = steps

        addOnclickToGridCells()

        if (!noReload) {
            loadTrack(currentTrack, true)
        }
    }

    function stepDurationChange(duration) {
        stepDuration = duration
        if (autoStepIntervalIdArray.length) {
            startAutoplay()
        }
    }

    function highlightStep(step) {
        currentStep = step
        document.title = `Step ${step + 1}/${theGrid.rows[0].cells.length - 1}`

        // unhighlight all steps
        var colClass = document.querySelectorAll(".currentStep")
        colClass.forEach(element => {
            element.classList.remove("currentStep")
        });

        // highlight step
        var colClass = document.querySelectorAll(`.step_${step}`)
        colClass.forEach(element => {
            element.classList.add("currentStep")
        });
    }

    function advanceStep() {
        currentStep = (currentStep + 1) % stepCount
        highlightStep(currentStep)
        var notes = getCurrentStepActiveCellNoteArray()
        playChordArray(notes)

    }

    function addOnclickToGridCells() {
        var theGrid = document.getElementById("theGrid")
        for (var row = 1; row < theGrid.rows.length; row++) {
            for (var col = 1; col < theGrid.rows[row].cells.length; col++) {
                var cell = theGrid.rows[row].cells[col]
                cell.onclick = function () {
                    this.classList.toggle("activeCell")
                    if (this.classList.contains("activeCell")) {
                        initAudioContext();
                        playNoteByName(this.parentElement.cells[0].innerText)
                    }
                }
            }
        }
        // add event to headers
        for (var col = 0; col < theGrid.rows[0].cells.length; col++) {
            var cell = theGrid.rows[0].cells[col]
            cell.onclick = function () {
                highlightStep(Array.from(this.parentNode.children).indexOf(this) - 1)
            }
        }
    }

    function getCurrentStepActiveCellNoteArray() {
        var noteElements = document.querySelectorAll(".activeCell.currentStep")
        var noteArray = [...noteElements].map(x =>
            x.parentElement.cells[0].innerText
        )
        return noteArray ? noteArray : []
    }

    function playNoteByName(noteName) {
        `
        Plays a note given a name, e.g. A4 or C♯3
        Will let you get away with using # instead of ♯
        Assumes you have an audio context called audioCtx
        `
        var noteFrequency = getFrequencyFromNoteName(noteName)

        // for reference
        // you can make a kickdrum with
        // oscillator.frequency.exponentialRampToValueAtTime(0.001, audioCtx.currentTime+0.5)

        var oscillator = audioCtx.createOscillator();
        oscillator.type = waveform ? waveform : "sine";
        oscillator.frequency.setValueAtTime(noteFrequency, audioCtx.currentTime); // value in hertz
        oscillator.connect(mainGainNode);
        oscillator.start();
        oscillator.stop(audioCtx.currentTime + stepDuration);
    }

    function getFrequencyFromNoteName(noteName) {
        `
        Gets frequency in Hz for a note given a name, e.g. A4 or C♯3
        Will let you get away with using # instead of ♯
        Breaks above G#9 because of the assumption that the octave is always a single digit
        `
        var note = noteName.slice(0, noteName.length - 1).replace("#", "♯")
        var octave = parseInt(noteName.slice(noteName.length - 1))
        var noteIdx = chromaticScale.indexOf(note)

        var noteValueRelativeToA4 = noteIdx + (12 * (octave - 4))
        var noteFrequency = (2 ** (noteValueRelativeToA4 / 12)) * 440

        return noteFrequency
    }

    function playChordArray(chordArray) {
        volume = 1 / (chordArray.length * 2)
        chordArray.map(x => setTimeout(playNoteByName, 0, x))
    }

    function getTheScore(asString) {
        var theScore = {}

        theScore["notes"] = [...document.getElementById("theGrid").getElementsByClassName("activeCell")].map(x =>
            [
                x.parentElement.cells[0].innerText,
                Array.from(x.parentNode.children).indexOf(x) - 1
            ]
        )

        theScore["steps"] = stepCount
        theScore["duration"] = stepDuration
        theScore["waveform"] = waveform
        theScore["octaves"] = numberOfOctaves
        theScore["startOctave"] = startOctave

        if (asString) {
            return JSON.stringify(theScore)
        }
        else {
            return theScore
        }
    }

    function loadTrack(trackData, noStepChange) {
        clearNotes()

        // load the data
        var notesArray = trackData["notes"]
        var steps = trackData["steps"]
        var duration = trackData["duration"]
        var waveform = trackData["waveform"]
        var octaves = Object.keys(trackData).includes("octaves") ? trackData["octaves"] : 2
        var octaveStart = Object.keys(trackData).includes("startOctave") ? trackData["startOctave"] : 3

        if (!notesArray) {
            console.warn("No notes in trackData")
            return
        }

        // octaves
        document.getElementById("octaveSpinner").value = octaves
        document.getElementById("startOctaveSpinner").value = octaveStart
        numberOfOctaves = octaves
        startOctave = octaveStart

        // steps
        document.getElementById("stepSpinner").value = steps
        stepCount = steps
        stepChange(steps, true)

        // notes
        for (var i = 0; i < notesArray.length; i++) {
            var note = notesArray[i][0]
            var step = notesArray[i][1]
            var rowElement = document.querySelector(`[data-note=${note}]`).parentElement
            try {
                var cell = rowElement.cells[step + 1]
                cell.classList.add("activeCell")
            }
            catch {
                console.warn(`Cannot place ${note} at step ${step}, truncating score`)
            }
        }

        // step duration
        document.getElementById("stepDurationSpinner").value = duration
        stepDurationChange(duration)

        // waveform
        document.getElementById("waveformSelection").value = waveform
        changeWaveform(waveform)
    }

    function initAudioContext() {
        if (!audioCtx) {
            audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            mainGainNode = audioCtx.createGain();
            mainGainNode.connect(audioCtx.destination);
            mainGainNode.gain.value = volume;
        }
    }

    function clearNotes() {
        document.querySelectorAll(".activeCell").forEach(element => {
            element.classList.remove("activeCell")
        });
    }

    function startAutoplay() {
        stopAutoplay()
        autoStepIntervalIdArray.push(setInterval(advanceStep, stepDuration * 1000))
    }

    function stopAutoplay() {
        while (autoStepIntervalIdArray.length) {
            clearInterval(autoStepIntervalIdArray.pop())
        }
    }

    function trackSelectorGenerator() {
        var outhtml = "<select onchange='loadTrack(tracks[this.value])' id='trackSelection'><option disabled selected>Select a track</option>"
        var caArray = Object.keys(tracks).sort()

        for (var ca_idx in caArray) {
            outhtml += `<option value='${caArray[ca_idx]}'>${caArray[ca_idx]}</option>`
        }
        outhtml += "</select>"
        document.getElementById("trackSelection").innerHTML = outhtml
    }

    function doExport() {
        if (document.getElementById("exportDiv")) {
            document.getElementById("exportText").value = getTheScore(1)
        }
        else {
            createLoadExportCard()
            doExport()
        }
    }

    function download(filename, text) {
        var element = document.createElement('a');
        element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
        element.setAttribute('download', filename);

        element.style.display = 'none';
        document.body.appendChild(element);

        element.click();

        document.body.removeChild(element);
    }

    function doLoad() {
        if (document.getElementById("exportDiv")) {
            loadTrack(JSON.parse(document.getElementById("exportText").value))
        }
        else {
            createLoadExportCard()
        }
    }

    function createLoadExportCard() {
        var node = document.createElement("div")
        node.id = "exportDiv"
        node.classList.add("card")
        var textareaNode = document.createElement("textarea")
        textareaNode.id = "exportText"
        textareaNode.placeholder = "Paste track data in here (or choose file) then click load again"
        node.appendChild(textareaNode)
        document.getElementById("controls").after(node)

        var loadExportButtonsDiv = document.createElement("div")
        loadExportButtonsDiv.id = "loadExportButtonsDiv"
        node.appendChild(loadExportButtonsDiv)

        var uploadButton = document.createElement("input")
        uploadButton.setAttribute("type", "file")
        uploadButton.id = "file"
        uploadButton.oninput = loadTrackFromJsonFile
        uploadButton.classList.add("skeuButton")
        uploadButton.textContent = "Open file"
        loadExportButtonsDiv.appendChild(uploadButton)

        var button = document.createElement("button")
        button.onclick = function () {
            download("track.json", textareaNode.value)
        }
        button.classList.add("skeuButton")
        button.textContent = "Download"
        loadExportButtonsDiv.appendChild(button)
    }

    function changeWaveform(waveformSetting) {
        waveform = waveformSetting
    }

    function reloadTrack() {
        loadTrack(getTheScore())
    }

    function octaveChange(octave) {
        numberOfOctaves = octave
        reloadTrack()
    }

    function startOctaveChange(octave) {
        startOctave = octave
        reloadTrack()
    }

    function hideCard(card) {
        card.parentElement.classList.toggle("card_hidden")
    }

    function insertColAtCurrentPos() {
        var currentScore = getTheScore()
        var newScore = currentScore
        var currentScoreNotesArray = currentScore["notes"]
        var newScoreNotesArray = []

        for (var i = 0; i < currentScoreNotesArray.length; i++) {
            var note = currentScoreNotesArray[i][0]
            var pos = currentScoreNotesArray[i][1]

            if (pos > currentStep) {
                pos++
            }

            newScoreNotesArray.push([note, pos])
        }

        newScore["notes"] = newScoreNotesArray
        newScore["steps"] = newScore["steps"] + 1

        loadTrack(newScore)
        highlightStep(currentStep)
    }

    function doBarShading(barLength) {
        var rule = `
            #theGrid td:nth-child(${barLength}n + 1){
                border-right: 1px solid royalblue !important;
            }
        `
        if (!document.getElementById("barshadestyle")) {
            var ruleElm = document.createElement("style")
            ruleElm.id = "barshadestyle"
            document.body.append(ruleElm)
        }
        else {
            var ruleElm = document.getElementById("barshadestyle")
        }

        ruleElm.innerText = rule
    }

    // stackoverflow saves the day again
    function b64DecodeUnicode(str) {
        // Going backwards: from bytestream, to percent-encoding, to original string.
        return decodeURIComponent(atob(str).split('').map(function (c) {
            return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
        }).join(''));
    }

    function loadTrackFromJsonFile() {
        if (document.querySelector("#file").value == '') {
            document.getElementById("exportText").value = 'No file selected';
            return;
        }

        var file = document.querySelector("#file").files[0];

        var reader = new FileReader();
        reader.onload = function (e) {
            // document.getElementById("exportText").value = (e.target.result);
            document.getElementById("exportText").value = b64DecodeUnicode(e.target.result.split(",")[1]);
        };
        reader.onerror = function (e) {
            document.getElementById("exportText").value = 'Error reading file';
        };
        reader.readAsDataURL(file);
    }

    function wideMode() {
        var controlsDiv = document.getElementById("controls")
        controlsDiv.style.justifyContent = "space-evenly"
        controlsDiv.style.flexDirection = "row"
        controlsDiv.style.alignItems = "center"
        document.body.style.maxWidth = 'calc(100vw - 30px)'
        window.history.replaceState(null, null, "?wide=1");
    }

    function read_url_params_and_apply() {
        var url_string = window.location.href
        var url = new URL(url_string)
        try{
            var wide = parseInt(url.searchParams.get("wide"))
            if (wide){
                console.log(wide)
                wideMode()
            }
        }
        catch{
            console.warn("Not impressed with your invalid URL parameters")
        }
    }


    function init() {
        stepChange(stepCount);
        trackSelectorGenerator();
        window.onbeforeunload = function () { return "Your work will be lost."; };
        read_url_params_and_apply()
    }

    // globals
    var numberOfOctaves = 2
    var startOctave = 3
    var stepCount = 16
    var currentStep = -1
    var stepDuration = 0.5
    var chromaticScale = ["A", "A♯", "B", "C", "C♯", "D", "D♯", "E", "F", "F♯", "G", "G♯"]
    var audioCtx
    var mainGainNode
    var volume = 0.5
    var autoStepIntervalIdArray = []
    var waveform = "sine"
    var tempState

    var tracks = {
        "stillAlive": {
            "notes": [["F4", 0], ["F4", 6], ["F4", 17], ["E4", 1], ["E4", 4], ["E4", 7], ["E4", 10], ["E4", 16], ["E4", 24], ["D4", 2], ["D4", 3], ["D4", 8], ["D4", 9], ["D4", 12], ["D4", 15], ["D4", 18], ["D4", 21], ["C4", 11], ["C4", 20], ["B4", 19], ["G3", 5], ["G3", 13], ["G3", 14], ["G3", 22], ["G3", 23]],
            "steps": 27,
            "duration": 0.38,
            "waveform": "sine"
        },
        "blue": {
            "notes": [["F♯4", 12], ["F♯4", 13], ["F♯4", 14], ["F♯4", 15], ["E4", 0], ["E4", 1], ["E4", 2], ["E4", 3], ["E4", 4], ["E4", 5], ["E4", 6], ["E4", 7], ["E4", 8], ["E4", 9], ["E4", 10], ["E4", 11], ["D♯4", 12], ["D♯4", 13], ["D♯4", 14], ["D♯4", 15], ["C♯4", 4], ["C♯4", 5], ["C♯4", 6], ["C♯4", 7], ["B4", 0], ["B4", 1], ["B4", 2], ["B4", 3], ["B4", 8], ["B4", 9], ["B4", 10], ["B4", 11], ["A4", 12], ["A4", 13], ["A4", 14], ["A4", 15], ["G♯3", 0], ["G♯3", 1], ["G♯3", 2], ["G♯3", 3], ["G♯3", 8], ["G♯3", 9], ["G♯3", 10], ["G♯3", 11], ["G3", 4], ["G3", 5], ["G3", 6], ["G3", 7], ["F♯3", 12], ["F♯3", 13], ["F♯3", 14], ["F♯3", 15], ["E3", 4], ["E3", 5], ["E3", 6], ["E3", 7], ["D3", 0], ["D3", 1], ["D3", 2], ["D3", 3], ["D3", 8], ["D3", 9], ["D3", 10], ["D3", 11], ["B3", 0], ["B3", 1], ["B3", 2], ["B3", 3], ["B3", 8], ["B3", 9], ["B3", 10], ["B3", 11], ["B3", 12], ["B3", 13], ["B3", 14], ["B3", 15], ["A3", 4], ["A3", 5], ["A3", 6], ["A3", 7]],
            "steps": 16,
            "duration": 0.35,
            "waveform": "sine"
        },
        "blueLong": {
            "notes": [["F♯4", 24], ["F♯4", 25], ["F♯4", 26], ["F♯4", 27], ["F♯4", 28], ["F♯4", 29], ["F♯4", 30], ["F♯4", 31], ["E4", 0], ["E4", 1], ["E4", 2], ["E4", 3], ["E4", 4], ["E4", 5], ["E4", 6], ["E4", 7], ["E4", 8], ["E4", 9], ["E4", 10], ["E4", 11], ["E4", 12], ["E4", 13], ["E4", 14], ["E4", 15], ["E4", 16], ["E4", 17], ["E4", 18], ["E4", 19], ["E4", 20], ["E4", 21], ["E4", 22], ["E4", 23], ["D♯4", 24], ["D♯4", 25], ["D♯4", 26], ["D♯4", 27], ["D♯4", 28], ["D♯4", 29], ["D♯4", 30], ["D♯4", 31], ["C♯4", 8], ["C♯4", 9], ["C♯4", 10], ["C♯4", 11], ["C♯4", 12], ["C♯4", 13], ["C♯4", 14], ["C♯4", 15], ["B4", 0], ["B4", 1], ["B4", 2], ["B4", 3], ["B4", 4], ["B4", 5], ["B4", 6], ["B4", 7], ["B4", 16], ["B4", 17], ["B4", 18], ["B4", 19], ["B4", 20], ["B4", 21], ["B4", 22], ["B4", 23], ["A4", 24], ["A4", 25], ["A4", 26], ["A4", 27], ["A4", 28], ["A4", 29], ["A4", 30], ["A4", 31], ["G♯3", 0], ["G♯3", 1], ["G♯3", 2], ["G♯3", 3], ["G♯3", 4], ["G♯3", 5], ["G♯3", 6], ["G♯3", 7], ["G♯3", 16], ["G♯3", 17], ["G♯3", 18], ["G♯3", 19], ["G♯3", 20], ["G♯3", 21], ["G♯3", 22], ["G♯3", 23], ["G3", 8], ["G3", 9], ["G3", 10], ["G3", 11], ["G3", 12], ["G3", 13], ["G3", 14], ["G3", 15], ["F♯3", 24], ["F♯3", 25], ["F♯3", 26], ["F♯3", 27], ["F♯3", 28], ["F♯3", 29], ["F♯3", 30], ["F♯3", 31], ["E3", 8], ["E3", 9], ["E3", 10], ["E3", 11], ["E3", 12], ["E3", 13], ["E3", 14], ["E3", 15], ["D♯3", 0], ["D♯3", 1], ["D♯3", 2], ["D♯3", 3], ["D♯3", 4], ["D♯3", 5], ["D♯3", 6], ["D♯3", 7], ["D♯3", 16], ["D♯3", 17], ["D♯3", 18], ["D♯3", 19], ["D♯3", 20], ["D♯3", 21], ["D♯3", 22], ["D♯3", 23], ["B3", 0], ["B3", 1], ["B3", 2], ["B3", 3], ["B3", 4], ["B3", 5], ["B3", 6], ["B3", 7], ["B3", 16], ["B3", 17], ["B3", 18], ["B3", 19], ["B3", 20], ["B3", 21], ["B3", 22], ["B3", 23], ["B3", 24], ["B3", 25], ["B3", 26], ["B3", 27], ["B3", 28], ["B3", 29], ["B3", 30], ["B3", 31], ["A3", 8], ["A3", 9], ["A3", 10], ["A3", 11], ["A3", 12], ["A3", 13], ["A3", 14], ["A3", 15]],
            "steps": 32,
            "duration": 0.22,
            "waveform": "sine"
        },
        "sayonara": {
            "notes": [["D♯4", 4], ["D♯4", 6], ["C♯4", 0], ["C♯4", 2], ["C♯4", 8], ["C♯4", 11], ["B4", 10], ["B4", 20], ["B4", 26], ["A♯4", 12], ["A♯4", 16], ["A♯4", 18], ["A♯4", 21], ["A♯4", 24], ["A♯4", 27], ["G♯3", 15], ["G♯3", 22], ["G♯3", 28], ["F♯3", 1], ["F♯3", 3], ["F♯3", 5], ["F♯3", 7], ["F♯3", 9], ["F♯3", 14], ["F♯3", 17], ["F♯3", 19], ["F♯3", 23], ["F♯3", 30], ["F♯3", 32]],
            "steps": 35,
            "duration": 0.38,
            "waveform": "sine"
        },
        "centre": {
            "notes": [["B4", 3], ["A4", 5], ["G♯3", 7], ["G♯3", 16], ["G♯3", 22], ["F♯3", 8], ["F♯3", 18], ["E3", 0], ["E3", 2], ["E3", 21], ["D♯3", 9], ["D♯3", 13], ["D♯3", 15], ["D♯3", 20], ["B3", 1], ["B3", 14]],
            "steps": 27,
            "duration": 0.3,
            "waveform": "square"
        },
        "noPrinter": {
            "notes": [["D4", 8], ["C♯4", 9], ["B4", 2], ["B4", 6], ["B4", 10], ["A4", 0], ["A4", 3], ["A4", 7], ["A4", 11], ["A4", 16], ["A4", 18], ["A4", 20], ["A4", 22], ["A4", 24], ["A4", 26], ["A4", 28], ["A4", 30], ["A4", 35], ["A4", 40], ["A4", 42], ["A4", 44], ["A4", 48], ["A4", 50], ["A4", 52], ["A4", 54], ["A4", 56], ["A4", 58], ["A4", 60], ["A4", 62], ["A4", 67], ["A4", 72], ["A4", 74], ["A4", 76], ["A4", 105], ["A4", 107], ["G♯3", 106], ["G3", 12], ["G3", 32], ["G3", 34], ["G3", 36], ["G3", 64], ["G3", 66], ["G3", 68], ["G3", 98], ["G3", 100], ["G3", 102], ["G3", 104], ["F♯3", 13], ["F♯3", 37], ["F♯3", 69], ["F♯3", 90], ["F♯3", 92], ["F♯3", 94], ["F♯3", 96], ["E3", 14], ["E3", 31], ["E3", 33], ["E3", 38], ["E3", 63], ["E3", 65], ["E3", 70], ["E3", 82], ["E3", 84], ["E3", 86], ["E3", 88], ["E3", 97], ["E3", 101], ["E3", 103], ["D3", 15], ["D3", 17], ["D3", 19], ["D3", 21], ["D3", 23], ["D3", 25], ["D3", 27], ["D3", 29], ["D3", 39], ["D3", 41], ["D3", 43], ["D3", 45], ["D3", 47], ["D3", 49], ["D3", 51], ["D3", 53], ["D3", 55], ["D3", 57], ["D3", 59], ["D3", 61], ["D3", 71], ["D3", 73], ["D3", 75], ["D3", 77], ["D3", 89], ["D3", 93], ["C♯3", 46], ["C♯3", 81], ["C♯3", 85], ["C♯3", 99], ["B3", 79], ["A3", 78], ["A3", 80], ["A3", 83], ["A3", 91], ["A3", 95]],
            "steps": 108,
            "duration": 0.4,
            "waveform": "square"
        },
        "twoThousand": {
            "notes": [["E4", 15], ["D4", 16], ["B4", 13], ["B4", 17], ["B4", 23], ["A4", 19], ["A4", 24], ["A4", 27], ["G3", 1], ["G3", 8], ["G3", 12], ["G3", 18], ["G3", 26], ["G3", 28], ["F♯3", 2], ["F♯3", 9], ["E3", 0], ["E3", 4], ["E3", 7], ["E3", 11], ["E3", 20], ["E3", 22], ["E3", 30], ["D3", 3], ["D3", 25], ["D3", 29], ["B3", 5], ["B3", 10]],
            "steps": 32,
            "duration": 0.5,
            "waveform": "sine"
        },
        "noStrangers": {
            "notes": [["C4", 11], ["A♯4", 12], ["A4", 10], ["A4", 13], ["G3", 3], ["G3", 7], ["G3", 17], ["G3", 21], ["F3", 0], ["F3", 10], ["F3", 14], ["F3", 23], ["E3", 3], ["E3", 7], ["E3", 17], ["E3", 21], ["D3", 0], ["D3", 10], ["D3", 14], ["D3", 23], ["C3", 3], ["C3", 5], ["C3", 7], ["C3", 17], ["C3", 19], ["C3", 21], ["A♯3", 0], ["A♯3", 14], ["A♯3", 23]],
            "steps": 24,
            "duration": 0.25,
            "waveform": "sine"
        },
        "shootingStars": {
            "notes": [["G4", 28], ["D4", 16], ["D4", 20], ["D4", 24], ["D4", 28], ["C4", 4], ["C4", 12], ["B4", 0], ["B4", 2], ["B4", 8], ["B4", 10], ["B4", 16], ["B4", 22], ["B4", 24], ["B4", 30], ["G3", 0], ["G3", 6], ["G3", 8], ["G3", 14], ["G3", 17], ["G3", 19], ["G3", 21], ["G3", 23], ["G3", 25], ["G3", 27], ["G3", 29], ["G3", 31], ["E3", 1], ["E3", 3], ["E3", 5], ["E3", 7], ["E3", 9], ["E3", 11], ["E3", 13], ["E3", 15], ["D3", 0], ["D3", 6], ["D3", 8], ["D3", 10], ["D3", 14], ["D3", 16], ["D3", 18], ["D3", 24], ["D3", 26], ["B3", 2], ["B3", 7], ["B3", 8], ["B3", 10], ["B3", 15], ["B3", 16], ["B3", 22], ["B3", 30]],
            "steps": 32,
            "duration": 0.25,
            "waveform": "square"
        },
        "loss": {
            "notes": [["G♯4", 0], ["G♯4", 1], ["G♯4", 2], ["G♯4", 3], ["G♯4", 4], ["G♯4", 5], ["G♯4", 6], ["G♯4", 7], ["G♯4", 8], ["G♯4", 9], ["G♯4", 10], ["G♯4", 11], ["G♯4", 12], ["G♯4", 13], ["G♯4", 14], ["G♯4", 15], ["G♯4", 16], ["G♯4", 17], ["G♯4", 18], ["G4", 0], ["G4", 9], ["G4", 18], ["F♯4", 0], ["F♯4", 9], ["F♯4", 18], ["F4", 0], ["F4", 3], ["F4", 9], ["F4", 12], ["F4", 18], ["E4", 0], ["E4", 3], ["E4", 9], ["E4", 12], ["E4", 18], ["D♯4", 0], ["D♯4", 3], ["D♯4", 9], ["D♯4", 12], ["D♯4", 15], ["D♯4", 18], ["D4", 0], ["D4", 3], ["D4", 9], ["D4", 12], ["D4", 15], ["D4", 18], ["C♯4", 0], ["C♯4", 3], ["C♯4", 9], ["C♯4", 12], ["C♯4", 15], ["C♯4", 18], ["C4", 0], ["C4", 3], ["C4", 9], ["C4", 12], ["C4", 15], ["C4", 18], ["B4", 0], ["B4", 3], ["B4", 9], ["B4", 12], ["B4", 15], ["B4", 18], ["A♯4", 0], ["A♯4", 9], ["A♯4", 18], ["A4", 0], ["A4", 9], ["A4", 18], ["G♯3", 0], ["G♯3", 1], ["G♯3", 2], ["G♯3", 3], ["G♯3", 4], ["G♯3", 5], ["G♯3", 6], ["G♯3", 7], ["G♯3", 8], ["G♯3", 9], ["G♯3", 10], ["G♯3", 11], ["G♯3", 12], ["G♯3", 13], ["G♯3", 14], ["G♯3", 15], ["G♯3", 16], ["G♯3", 17], ["G♯3", 18], ["G3", 0], ["G3", 9], ["G3", 18], ["F♯3", 0], ["F♯3", 9], ["F♯3", 18], ["F3", 0], ["F3", 2], ["F3", 6], ["F3", 9], ["F3", 11], ["F3", 18], ["E3", 0], ["E3", 2], ["E3", 6], ["E3", 9], ["E3", 11], ["E3", 18], ["D♯3", 0], ["D♯3", 2], ["D♯3", 6], ["D♯3", 9], ["D♯3", 11], ["D♯3", 18], ["D3", 0], ["D3", 2], ["D3", 6], ["D3", 9], ["D3", 11], ["D3", 18], ["C♯3", 0], ["C♯3", 2], ["C♯3", 6], ["C♯3", 9], ["C♯3", 11], ["C♯3", 18], ["C3", 0], ["C3", 2], ["C3", 6], ["C3", 9], ["C3", 11], ["C3", 13], ["C3", 14], ["C3", 15], ["C3", 16], ["C3", 18], ["B3", 0], ["B3", 9], ["B3", 18], ["A♯3", 0], ["A♯3", 9], ["A♯3", 18], ["A3", 0], ["A3", 1], ["A3", 2], ["A3", 3], ["A3", 4], ["A3", 5], ["A3", 6], ["A3", 7], ["A3", 8], ["A3", 9], ["A3", 10], ["A3", 11], ["A3", 12], ["A3", 13], ["A3", 14], ["A3", 15], ["A3", 16], ["A3", 17], ["A3", 18]],
            "steps": 19,
            "duration": 0.25,
            "waveform": "sine"
        },
        "doughnutSteel": {
            "notes": [["F♯4", 2], ["F♯4", 10], ["F♯4", 20], ["E4", 1], ["E4", 9], ["E4", 19], ["E4", 21], ["D4", 0], ["D4", 8], ["D4", 18], ["D4", 22], ["D4", 26], ["C♯4", 17], ["C♯4", 23], ["C♯4", 25], ["B4", 4], ["B4", 12], ["B4", 16], ["B4", 24], ["A4", 1], ["A4", 3], ["A4", 5], ["A4", 9], ["A4", 11], ["A4", 13], ["G3", 6], ["G3", 14], ["G3", 20], ["G3", 28], ["F♯3", 7], ["F♯3", 15], ["F♯3", 17], ["F♯3", 19], ["F♯3", 21], ["F♯3", 25], ["F♯3", 27], ["F♯3", 29], ["E3", 22], ["E3", 30], ["D3", 0], ["D3", 2], ["D3", 8], ["D3", 10], ["D3", 23], ["D3", 31], ["B3", 16], ["B3", 18], ["B3", 24], ["B3", 26]],
            "steps": 32,
            "duration": 0.25,
            "waveform": "sine"
        },
        "vlTone": {
            "notes": [["E4", 14], ["E4", 15], ["E4", 31], ["E4", 46], ["D4", 13], ["D4", 16], ["D4", 32], ["D4", 38], ["C♯4", 10], ["C♯4", 11], ["C♯4", 18], ["C♯4", 19], ["C♯4", 20], ["C♯4", 33], ["C♯4", 34], ["C♯4", 35], ["C♯4", 40], ["C♯4", 48], ["B4", 6], ["B4", 7], ["B4", 8], ["B4", 13], ["B4", 22], ["B4", 23], ["B4", 24], ["B4", 41], ["B4", 42], ["B4", 43], ["B4", 52], ["B4", 53], ["B4", 54], ["B4", 55], ["A4", 2], ["A4", 3], ["A4", 4], ["A4", 26], ["A4", 27], ["A4", 48], ["A4", 50], ["A4", 51], ["A4", 56], ["A4", 57], ["A4", 58], ["A4", 59], ["A4", 60], ["A4", 61], ["G♯3", 10], ["G♯3", 18], ["G♯3", 33], ["F♯3", 6], ["F♯3", 22], ["F♯3", 41], ["F♯3", 52], ["E3", 0], ["E3", 1], ["E3", 18], ["C♯3", 2], ["C♯3", 26], ["C♯3", 56], ["A3", 0]],
            "steps": 62,
            "duration": 0.2,
            "waveform": "square"
        },
        "undertale": {
            "notes": [["C6", 348], ["A♯6", 264], ["A♯6", 296], ["A♯6", 336], ["A♯6", 352], ["F5", 272], ["F5", 360], ["D♯5", 288], ["D♯5", 368], ["D5", 328], ["C5", 348], ["A♯5", 256], ["A♯5", 264], ["A♯5", 296], ["A♯5", 304], ["A♯5", 320], ["A♯5", 336], ["A♯5", 352], ["G4", 54], ["G4", 118], ["G4", 182], ["G4", 246], ["G4", 310], ["G4", 374], ["F4", 2], ["F4", 34], ["F4", 56], ["F4", 62], ["F4", 66], ["F4", 98], ["F4", 120], ["F4", 126], ["F4", 130], ["F4", 162], ["F4", 184], ["F4", 190], ["F4", 194], ["F4", 226], ["F4", 248], ["F4", 254], ["F4", 258], ["F4", 272], ["F4", 290], ["F4", 312], ["F4", 318], ["F4", 322], ["F4", 354], ["F4", 360], ["F4", 376], ["F4", 382], ["D♯4", 4], ["D♯4", 14], ["D♯4", 20], ["D♯4", 30], ["D♯4", 36], ["D♯4", 46], ["D♯4", 52], ["D♯4", 59], ["D♯4", 68], ["D♯4", 78], ["D♯4", 84], ["D♯4", 94], ["D♯4", 100], ["D♯4", 110], ["D♯4", 116], ["D♯4", 123], ["D♯4", 132], ["D♯4", 142], ["D♯4", 148], ["D♯4", 158], ["D♯4", 164], ["D♯4", 174], ["D♯4", 180], ["D♯4", 187], ["D♯4", 196], ["D♯4", 206], ["D♯4", 212], ["D♯4", 222], ["D♯4", 228], ["D♯4", 238], ["D♯4", 244], ["D♯4", 251], ["D♯4", 260], ["D♯4", 270], ["D♯4", 276], ["D♯4", 286], ["D♯4", 288], ["D♯4", 292], ["D♯4", 302], ["D♯4", 308], ["D♯4", 315], ["D♯4", 324], ["D♯4", 334], ["D♯4", 350], ["D♯4", 356], ["D♯4", 366], ["D♯4", 368], ["D♯4", 372], ["D♯4", 379], ["D4", 8], ["D4", 11], ["D4", 24], ["D4", 27], ["D4", 40], ["D4", 43], ["D4", 72], ["D4", 75], ["D4", 88], ["D4", 91], ["D4", 104], ["D4", 107], ["D4", 136], ["D4", 139], ["D4", 152], ["D4", 155], ["D4", 168], ["D4", 171], ["D4", 200], ["D4", 203], ["D4", 216], ["D4", 219], ["D4", 232], ["D4", 235], ["D4", 264], ["D4", 267], ["D4", 280], ["D4", 283], ["D4", 296], ["D4", 299], ["D4", 328], ["D4", 331], ["D4", 344], ["D4", 347], ["D4", 360], ["D4", 363], ["C4", 242], ["C4", 246], ["C4", 250], ["C4", 254], ["C4", 370], ["C4", 374], ["C4", 378], ["C4", 382], ["A♯4", 0], ["A♯4", 6], ["A♯4", 18], ["A♯4", 22], ["A♯4", 32], ["A♯4", 38], ["A♯4", 50], ["A♯4", 64], ["A♯4", 70], ["A♯4", 82], ["A♯4", 86], ["A♯4", 96], ["A♯4", 102], ["A♯4", 114], ["A♯4", 128], ["A♯4", 134], ["A♯4", 146], ["A♯4", 150], ["A♯4", 160], ["A♯4", 166], ["A♯4", 178], ["A♯4", 192], ["A♯4", 198], ["A♯4", 210], ["A♯4", 214], ["A♯4", 224], ["A♯4", 226], ["A♯4", 230], ["A♯4", 234], ["A♯4", 238], ["A♯4", 242], ["A♯4", 256], ["A♯4", 262], ["A♯4", 288], ["A♯4", 294], ["A♯4", 304], ["A♯4", 306], ["A♯4", 320], ["A♯4", 326], ["A♯4", 342], ["A♯4", 352], ["A♯4", 354], ["A♯4", 358], ["A♯4", 362], ["A♯4", 366], ["A♯4", 370], ["G♯3", 130], ["G♯3", 134], ["G♯3", 138], ["G♯3", 142], ["G♯3", 146], ["G♯3", 150], ["G♯3", 154], ["G♯3", 158], ["G♯3", 194], ["G♯3", 198], ["G♯3", 202], ["G♯3", 206], ["G♯3", 210], ["G♯3", 214], ["G♯3", 218], ["G♯3", 222], ["G♯3", 258], ["G♯3", 262], ["G♯3", 266], ["G♯3", 270], ["G♯3", 274], ["G♯3", 278], ["G♯3", 282], ["G♯3", 286], ["G♯3", 322], ["G♯3", 326], ["G♯3", 330], ["G♯3", 334], ["G♯3", 338], ["G♯3", 342], ["G♯3", 346], ["G♯3", 350], ["G3", 162], ["G3", 166], ["G3", 170], ["G3", 174], ["G3", 178], ["G3", 182], ["G3", 186], ["G3", 190], ["G3", 240], ["G3", 244], ["G3", 248], ["G3", 252], ["G3", 290], ["G3", 294], ["G3", 298], ["G3", 302], ["G3", 306], ["G3", 310], ["G3", 314], ["G3", 318], ["G3", 368], ["G3", 372], ["G3", 376], ["G3", 380], ["F3", 224], ["F3", 228], ["F3", 232], ["F3", 236], ["F3", 352], ["F3", 356], ["F3", 360], ["F3", 364], ["D♯3", 2], ["D♯3", 6], ["D♯3", 10], ["D♯3", 14], ["D♯3", 18], ["D♯3", 22], ["D♯3", 26], ["D♯3", 30], ["D♯3", 34], ["D♯3", 38], ["D♯3", 42], ["D♯3", 46], ["D♯3", 50], ["D♯3", 54], ["D♯3", 58], ["D♯3", 62], ["D♯3", 66], ["D♯3", 70], ["D♯3", 74], ["D♯3", 78], ["D♯3", 82], ["D♯3", 86], ["D♯3", 90], ["D♯3", 94], ["D♯3", 98], ["D♯3", 102], ["D♯3", 106], ["D♯3", 110], ["D♯3", 114], ["D♯3", 118], ["D♯3", 122], ["D♯3", 126], ["D♯3", 128], ["D♯3", 132], ["D♯3", 136], ["D♯3", 140], ["D♯3", 144], ["D♯3", 148], ["D♯3", 152], ["D♯3", 156], ["D♯3", 160], ["D♯3", 164], ["D♯3", 168], ["D♯3", 172], ["D♯3", 176], ["D♯3", 180], ["D♯3", 184], ["D♯3", 188], ["D♯3", 192], ["D♯3", 196], ["D♯3", 200], ["D♯3", 204], ["D♯3", 208], ["D♯3", 212], ["D♯3", 216], ["D♯3", 220], ["D♯3", 256], ["D♯3", 260], ["D♯3", 264], ["D♯3", 268], ["D♯3", 272], ["D♯3", 276], ["D♯3", 280], ["D♯3", 284], ["D♯3", 288], ["D♯3", 292], ["D♯3", 296], ["D♯3", 300], ["D♯3", 304], ["D♯3", 308], ["D♯3", 312], ["D♯3", 316], ["D♯3", 320], ["D♯3", 324], ["D♯3", 328], ["D♯3", 332], ["D♯3", 336], ["D♯3", 340], ["D♯3", 344], ["D♯3", 348]],
            "steps": 384,
            "duration": 0.15,
            "waveform": "triangle",
            "octaves": 4,
            "startOctave": 3
        },
        "something": {
            "notes": [["D♯5", 14], ["D5", 13], ["D5", 16], ["C5", 12], ["A♯5", 9], ["A♯5", 11], ["G♯4", 5], ["G4", 0], ["F4", 7], ["D♯4", 27], ["D4", 26], ["D4", 28], ["C4", 0], ["C4", 5], ["C4", 6], ["C4", 22], ["C4", 25], ["C4", 29], ["A♯4", 7], ["A♯4", 15], ["A♯4", 20], ["A♯4", 21], ["G3", 24], ["D♯3", 0], ["C3", 0], ["C3", 2], ["C3", 4], ["C3", 6], ["C3", 22], ["C3", 24], ["C3", 26], ["C3", 28], ["A♯3", 10], ["A♯3", 12], ["A♯3", 14], ["A♯3", 16], ["A♯3", 18], ["A♯3", 20]],
            "steps": 30,
            "duration": 0.25,
            "waveform": "square",
            "octaves": 3,
            "startOctave": 3
        }
    }

    // init
    init();
</script>

</html>